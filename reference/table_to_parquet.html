<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert an input file to parquet format — table_to_parquet • parquetize</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert an input file to parquet format — table_to_parquet"><meta name="description" content="This function allows to convert an input file to parquet format.
It handles SAS, SPSS and Stata files in a same function. There is only one function to use for these 3 cases.
For these 3 cases, the function guesses the data format using the extension of the input file (in the path_to_file argument).
Two conversions possibilities are offered :

Convert to a single parquet file. Argument path_to_parquet must then be used;
Convert to a partitioned parquet file. Additionnal arguments partition and partitioning must then be used;


To avoid overcharging R's RAM, the conversion can be done by chunk. One of arguments max_memory or max_rows must then be used.
This is very useful for huge tables and for computers with little RAM because the conversion is then done
with less memory consumption. For more information, see here."><meta property="og:description" content="This function allows to convert an input file to parquet format.
It handles SAS, SPSS and Stata files in a same function. There is only one function to use for these 3 cases.
For these 3 cases, the function guesses the data format using the extension of the input file (in the path_to_file argument).
Two conversions possibilities are offered :

Convert to a single parquet file. Argument path_to_parquet must then be used;
Convert to a partitioned parquet file. Additionnal arguments partition and partitioning must then be used;


To avoid overcharging R's RAM, the conversion can be done by chunk. One of arguments max_memory or max_rows must then be used.
This is very useful for huge tables and for computers with little RAM because the conversion is then done
with less memory consumption. For more information, see here."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parquetize</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/aa-conversions.html">Convert huge input file to parquet</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/ddotta/parquetize"><span class="fa fab fa-github fa-lg"></span> Contribute</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Convert an input file to parquet format</h1>
      <small class="dont-index">Source: <a href="https://github.com/ddotta/parquetize/blob/main/R/table_to_parquet.R" class="external-link"><code>R/table_to_parquet.R</code></a></small>
      <div class="d-none name"><code>table_to_parquet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows to convert an input file to parquet format. <br></p>
<p>It handles SAS, SPSS and Stata files in a same function. There is only one function to use for these 3 cases.
For these 3 cases, the function guesses the data format using the extension of the input file (in the <code>path_to_file</code> argument). <br></p>
<p>Two conversions possibilities are offered :</p>
<ul><li><p>Convert to a single parquet file. Argument <code>path_to_parquet</code> must then be used;</p></li>
<li><p>Convert to a partitioned parquet file. Additionnal arguments <code>partition</code> and <code>partitioning</code> must then be used;</p></li>
</ul><p>To avoid overcharging R's RAM, the conversion can be done by chunk. One of arguments <code>max_memory</code> or <code>max_rows</code> must then be used.
This is very useful for huge tables and for computers with little RAM because the conversion is then done
with less memory consumption. For more information, see <a href="https://ddotta.github.io/parquetize/articles/aa-conversions.html" class="external-link">here</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">table_to_parquet</span><span class="op">(</span></span>
<span>  <span class="va">path_to_file</span>,</span>
<span>  <span class="va">path_to_parquet</span>,</span>
<span>  max_memory <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chunk_size <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chunk_memory_size <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  columns <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  by_chunk <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  partition <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  encoding <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chunk_memory_sample_lines <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  compression <span class="op">=</span> <span class="st">"snappy"</span>,</span>
<span>  compression_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path-to-file">path_to_file<a class="anchor" aria-label="anchor" href="#arg-path-to-file"></a></dt>
<dd><p>String that indicates the path to the input file (don't forget the extension).</p></dd>


<dt id="arg-path-to-parquet">path_to_parquet<a class="anchor" aria-label="anchor" href="#arg-path-to-parquet"></a></dt>
<dd><p>String that indicates the path to the directory where the parquet files will be stored.</p></dd>


<dt id="arg-max-memory">max_memory<a class="anchor" aria-label="anchor" href="#arg-max-memory"></a></dt>
<dd><p>Memory size (in Mb) in which data of one parquet file should roughly fit.</p></dd>


<dt id="arg-max-rows">max_rows<a class="anchor" aria-label="anchor" href="#arg-max-rows"></a></dt>
<dd><p>Number of lines that defines the size of the chunk.
This argument can not be filled in if max_memory is used.</p></dd>


<dt id="arg-chunk-size">chunk_size<a class="anchor" aria-label="anchor" href="#arg-chunk-size"></a></dt>
<dd><p>DEPRECATED use max_rows</p></dd>


<dt id="arg-chunk-memory-size">chunk_memory_size<a class="anchor" aria-label="anchor" href="#arg-chunk-memory-size"></a></dt>
<dd><p>DEPRECATED use max_memory</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p>Character vector of columns to select from the input file (by default, all columns are selected).</p></dd>


<dt id="arg-by-chunk">by_chunk<a class="anchor" aria-label="anchor" href="#arg-by-chunk"></a></dt>
<dd><p>DEPRECATED use max_memory or max_rows instead</p></dd>


<dt id="arg-skip">skip<a class="anchor" aria-label="anchor" href="#arg-skip"></a></dt>
<dd><p>By default 0. This argument must be filled in if <code>by_chunk</code> is TRUE. Number of lines to ignore when converting.</p></dd>


<dt id="arg-partition">partition<a class="anchor" aria-label="anchor" href="#arg-partition"></a></dt>
<dd><p>String ("yes" or "no" - by default) that indicates whether you want to create a partitioned parquet file.
If "yes", <code>"partitioning"</code> argument must be filled in. In this case, a folder will be created for each modality of the variable filled in <code>"partitioning"</code>.
Be careful, this argument can not be "yes" if <code>max_memory</code> or <code>max_rows</code> argument are not NULL.</p></dd>


<dt id="arg-encoding">encoding<a class="anchor" aria-label="anchor" href="#arg-encoding"></a></dt>
<dd><p>String that indicates the character encoding for the input file.</p></dd>


<dt id="arg-chunk-memory-sample-lines">chunk_memory_sample_lines<a class="anchor" aria-label="anchor" href="#arg-chunk-memory-sample-lines"></a></dt>
<dd><p>Number of lines to read to evaluate max_memory. Default to 10 000.</p></dd>


<dt id="arg-compression">compression<a class="anchor" aria-label="anchor" href="#arg-compression"></a></dt>
<dd><p>compression algorithm. Default "snappy".</p></dd>


<dt id="arg-compression-level">compression_level<a class="anchor" aria-label="anchor" href="#arg-compression-level"></a></dt>
<dd><p>compression level. Meaning depends on compression algorithm.</p></dd>


<dt id="arg-user-na">user_na<a class="anchor" aria-label="anchor" href="#arg-user-na"></a></dt>
<dd><p>If <code>TRUE</code> variables with user defined missing will be read
into <code><a href="https://haven.tidyverse.org/reference/labelled_spss.html" class="external-link">haven::labelled_spss()</a></code> objects. If <code>FALSE</code>, the default, user-defined missings will be converted to <code>NA</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional format-specific arguments,  see <a href="https://arrow.apache.org/docs/r/reference/write_parquet.html" class="external-link">arrow::write_parquet()</a>
and <a href="https://arrow.apache.org/docs/r/reference/write_dataset.html" class="external-link">arrow::write_dataset()</a> for more informations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Parquet files, invisibly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Conversion from a SAS file to a single parquet file :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sas7bdat"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".parquet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet file under /tmp/Rtmp5JozyA/file19512d1c61f6.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> The /home/runner/work/_temp/Library/haven/examples/iris.sas7bdat file is available in parquet format under /tmp/Rtmp5JozyA/file19512d1c61f6.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conversion from a SPSS file to a single parquet file :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sav"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".parquet"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet file under /tmp/Rtmp5JozyA/file195141cde539.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> The /home/runner/work/_temp/Library/haven/examples/iris.sav file is available in parquet format under /tmp/Rtmp5JozyA/file195141cde539.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span><span class="co"># Conversion from a Stata file to a single parquet file without progress bar :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.dta"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".parquet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet file under /tmp/Rtmp5JozyA/file195158a5ecba.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> The /home/runner/work/_temp/Library/haven/examples/iris.dta file is available in parquet format under /tmp/Rtmp5JozyA/file195158a5ecba.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reading SPSS file by chunk (using `max_rows` argument)</span></span></span>
<span class="r-in"><span><span class="co"># and conversion to multiple parquet files :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sav"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  max_rows <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19516cda9a86-1-50.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19516cda9a86-51-100.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19516cda9a86-101-150.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet dataset under /tmp/Rtmp5JozyA/file19516cda9a86/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reading SPSS file by chunk (using `max_memory` argument)</span></span></span>
<span class="r-in"><span><span class="co"># and conversion to multiple parquet files of 5 Kb when loaded (5 Mb / 1024)</span></span></span>
<span class="r-in"><span><span class="co"># (in real files, you should use bigger value that fit in memory like 3000</span></span></span>
<span class="r-in"><span><span class="co"># or 4000) :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sav"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  max_memory <span class="op">=</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">1024</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19514bcdce05-1-82.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19514bcdce05-83-150.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet dataset under /tmp/Rtmp5JozyA/file19514bcdce05/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19514bcdce05-83-150.parquet...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reading SAS file by chunk of 50 lines with encoding</span></span></span>
<span class="r-in"><span><span class="co"># and conversion to multiple files :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sas7bdat"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  max_rows <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>  encoding <span class="op">=</span> <span class="st">"utf-8"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19515928f5f8-1-50.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19515928f5f8-51-100.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file19515928f5f8-101-150.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet dataset under /tmp/Rtmp5JozyA/file19515928f5f8/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conversion from a SAS file to a single parquet file and select only</span></span></span>
<span class="r-in"><span><span class="co"># few columns  :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sas7bdat"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".parquet"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"Petal_Length"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet file under /tmp/Rtmp5JozyA/file19511b777f5c.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> The /home/runner/work/_temp/Library/haven/examples/iris.sas7bdat file is available in parquet format under /tmp/Rtmp5JozyA/file19511b777f5c.parquet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conversion from a SAS file to a partitioned parquet file  :</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>  path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sas7bdat"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  partition <span class="op">=</span> <span class="st">"yes"</span>,</span></span>
<span class="r-in"><span>  partitioning <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span><span class="op">)</span> <span class="co"># vector use as partition key</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet dataset under /tmp/Rtmp5JozyA/file1951522b10e7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> The /home/runner/work/_temp/Library/haven/examples/iris.sas7bdat file is available in parquet format under /tmp/Rtmp5JozyA/file1951522b10e7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reading SAS file by chunk of 50 lines</span></span></span>
<span class="r-in"><span><span class="co"># and conversion to multiple files with zstd, compression level 10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/arrow_info.html" class="external-link">arrow_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">capabilities</span><span class="op">[[</span><span class="st">'zstd'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">table_to_parquet</span><span class="op">(</span></span></span>
<span class="r-in"><span>    path_to_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,<span class="st">"iris.sas7bdat"</span>, package <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    path_to_parquet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    max_rows <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    compression <span class="op">=</span> <span class="st">"zstd"</span>,</span></span>
<span class="r-in"><span>    compression_level <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file1951649ac0d6-1-50.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file1951649ac0d6-51-100.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing file1951649ac0d6-101-150.parquet...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data are available in parquet dataset under /tmp/Rtmp5JozyA/file1951649ac0d6/</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading data...</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Damien Dotta, Nicolas Chuche.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

